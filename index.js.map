{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '50360143-67f83f4bf6f92da79a63477ea';\n\nexport async function getImagesByQuery(query, page) {\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page,\n        per_page: 15,\n      },\n    });\n    return response.data;\n  } catch(error) {\n      // console.error('Axios error:', error);\n      throw error;\n    };\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst gallery = document.querySelector('.gallery');\nconst loaderEl = document.querySelector('.loader');\nconst loaderBtn = document.querySelector('.more-btn');\nlet lightbox;\n\nexport function createGallery(images) {\n  const markup = images\n    .map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n      `<li class=\"item-image\">\n        <a href=\"${largeImageURL}\">\n          <img class=\"image\" src=\"${webformatURL}\" alt=\"${tags}\">\n        </a>\n        <div class=\"info\">\n          <p class=\"info-item\"><span>Likes</span> ${likes}</p>\n          <p class=\"info-item\"><span>Views</span> ${views}</p>\n          <p class=\"info-item\"><span>Comments</span> ${comments}</p>\n          <p class=\"info-item\"><span>Downloads</span> ${downloads}</p>\n        </div>\n      </li>`\n    ).join('\\n');\n  gallery.insertAdjacentHTML('beforeend', markup);\n  if (!lightbox) {\n    lightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionsPosition: 'bottom',\n      captionsDelay: 250,\n    });\n  } else {\n    lightbox.refresh();\n  }\n}\n\nexport function showLoader() {\n  loaderEl?.classList.remove(\"hidden\");\n}\n\nexport function hideLoader() {\n  loaderEl?.classList.add(\"hidden\");\n}\n\nexport function clearGallery() {\n  if (!gallery) return;\n  gallery.innerHTML = '';\n  if (lightbox) {\n    lightbox.destroy();\n    lightbox = null;\n  }\n}\n\nexport function showLoadMoreButton() {\n  loaderBtn?.classList.remove(\"hidden\");\n}\n\nexport function hideLoadMoreButton() {\n  loaderBtn?.classList.add(\"hidden\");\n}\n\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { getImagesByQuery } from \"./js/pixabay-api\";\nimport { createGallery, clearGallery, showLoader, hideLoader, showLoadMoreButton, hideLoadMoreButton } from \"./js/render-functions\";\n\n\nconst searchForm = document.querySelector('.form');\nconst loaderBtn = document.querySelector('.more-btn');\nconst loaderElSp = document.querySelector('.js-loader');\n\n\nlet lightbox = new SimpleLightbox('.gallery a', { captionsData: \"alt\", captionDelay: 250 });\nlet currentPage = 1;\nlet maxPage;\nlet perPage = 15;\nlet currentQuery;\n\nsearchForm.addEventListener('submit', async evt => {\n  evt.preventDefault();\n  clearGallery();\n  hideLoadMoreButton();\n\n  const query = evt.target.elements['search-text'].value.trim();\n\n  if (query === '') {\n    iziToast.info({\n      title: '',\n      message: 'Please enter a search term to find images.',\n      position: 'topRight',\n      timeout: 3000,\n    });\n    return;\n  }\n\n  currentQuery = query;\n  currentPage = 1;\n\n  showLoader();\n  showLoadSpinner();\n\n  try {\n    const data = await getImagesByQuery(currentQuery, currentPage);\n    const images = data.hits;\n    const totalHits = data.totalHits;\n\n    if (images.length === 0) {\n      iziToast.warning({\n        title: 'Sorry',\n        message: 'There are no images matching your search query. Please try again!',\n        position: 'topRight',\n        timeout: 3000,\n      });\n      return;\n    }\n\n    maxPage = Math.ceil(totalHits / perPage);\n\n    createGallery(images);\n    searchForm.reset();\n\n    scrollPage();\n\n    if (currentPage >= maxPage) {\n      iziToast.info({\n        title: '',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        timeout: 3000,\n      });\n      hideLoadMoreButton();\n    } else {\n      showLoadMoreButton();\n    }\n  } catch (error) {\n    // console.error('Помилка при отриманні зображень:', error.message);\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to fetch images. Please try again later.',\n      position: 'topRight',\n      timeout: 3000,\n    });\n  } finally {\n    hideLoader();\n    hideLoadSpinner();\n  }\n});\n\nloaderBtn.addEventListener('click', async () => {\n  currentPage += 1;\n  hideLoadMoreButton();\n  showLoader();\n  showLoadSpinner();\n\n  try {\n    const data = await getImagesByQuery(currentQuery, currentPage);\n    const images = data.hits;\n\n    createGallery(images);\n\n    // scroll after load next page\n    scrollPage();\n\n    if (currentPage >= maxPage) {\n      iziToast.info({\n        title: '',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        timeout: 3000,\n      });\n      hideLoadMoreButton();\n      return;\n    }\n\n    showLoadMoreButton();\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to fetch images. Please try again later.',\n      position: 'topRight',\n      timeout: 3000,\n    });\n  } finally {\n    hideLoader();\n    hideLoadSpinner();\n  }\n});\n\nfunction showLoadSpinner() {\n  loaderElSp?.classList.add(\"load-spinner\");\n}\n\nfunction hideLoadSpinner() {\n  loaderElSp?.classList.remove(\"load-spinner\");\n}\n\nfunction scrollPage() {\n  const card = document.querySelector('.item-image');\n  if (card) {\n    const cardHeight = card.getBoundingClientRect().height;\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  }\n}"],"names":["BASE_URL","API_KEY","getImagesByQuery","query","page","axios","error","gallery","loaderEl","loaderBtn","lightbox","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","showLoader","hideLoader","clearGallery","showLoadMoreButton","hideLoadMoreButton","searchForm","loaderElSp","currentPage","maxPage","perPage","currentQuery","evt","iziToast","showLoadSpinner","data","totalHits","scrollPage","hideLoadSpinner","card","cardHeight"],"mappings":"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"}